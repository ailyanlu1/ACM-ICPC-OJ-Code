# 2008 Dhaka: Chemical Plant
## Solution

题目的意思比较复杂，尽量将题目多看几次。

解决这个问题的做法是重新拆点，重新建图，然后使用最短路算法解决。

对于每个点，例如点x，如果有连向x的边，在时间内t1,t2,t3...tk到达，那么就把点x拆成k个点，那么最短路的状态就可以表示 为：在ti时间内到达点x，损耗最小的物质数量。之后就建图，注意控制新建的图的边数量。

对于第一个sample：

<pre>
3 6 50
2 50
1 2 0 10 20 30
1 2 5 6 9 11
2 3 13 15 25 28
3 3 32 33 40 45
3 1 30 31 39 40
1 2 41 42 48 49
</pre>

拆成8个点：
<pre>
pit 1 time 0   newid 1
pit 1 time 40   newid 2
pit 2 time 11   newid 3
pit 2 time 30   newid 4
pit 2 time 49   newid 5
pit 2 time 50   newid 6
pit 3 time 28   newid 7
pit 3 time 45   newid 8
</pre>
比起现有的六条边，多了一个起点pit 1 time 0，和终点pit 2 time 50。这个也是最短路的起点和终点。

新图中的边：

<pre>
1 4 cost 20
1 3 cost 8
3 7 cost 7
7 8 cost 10
7 2 cost 4
2 5 cost 3
...
1 2 cost 40
3 4 cost 19
4 5 cost 19
5 6 cost 1
7 8 cost 17
</pre>
上半部分的边是不同的pit之间的连边。下半部分的边是同一个pit，不同时间之间的节点的连边。对于一个pit的一个时间，只有一条边连进去。这 条连进去的边，是时间上最靠后且满足题目要求的。也就是说，例如，在2号pit，有3条边到达3号pit，一条到达的时间是11，一条到达的时间是12， 一条到达的时间是13，而从3号pit到4号pit有一条边，最早出发时间为15，最迟到达时间为20。那么按道理从3号pit的所有时间状态，到达4号 pit的20时间，都应该有边。但是这样连边的话，会产生很多边。正确的连边方法是：3号pit时间11向3号pit时间12连边，3号pit时间12向 3号pit时间13连边，只有3号pit时间13向4号pit时间20连边。

具体的连边规则请看代码，注意正确计算时间耗费。在最短路算法的过程中，如果算到耗费大于给出的W，就不能从这个状态继续扩展下去。 
