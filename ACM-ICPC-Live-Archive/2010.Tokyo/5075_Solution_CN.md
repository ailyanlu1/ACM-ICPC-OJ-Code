# 2010 Tokyo: Intersection of Two Prisms

## Summary

有两个高度无限的直棱柱，一个垂直于xOy平面，给出其在xOy横截面上的坐标；一个垂直于xOz平面，给出其在xOz横截面上的坐标。两个直棱柱的横截面都是凸多边形，求这两个直棱柱相交部分的面积。 

## Solution

两个直棱柱的横截面多边形都有x轴的坐标，而且坐标都是整数，因此可以沿X方向，利用定积分的思想，按照△X=1的步长来进行积分，累计体积分量，汇总后即可得总体积。此时，通过画图可知道，每个积分单位上面的三维图形都是一个拟棱柱。（拟棱柱：上底与下底平行，侧面都是梯形或者三角形）拟棱柱有体积公式：V=(S<sub>上</sub>+4×S<sub>中</sub>+S<sub>下</sub>)/6。而且这个拟棱柱比较特殊，上底和下底都是矩形，面积容易求得。因此，我们只需要求出：位于xOy面上的多边形在Y轴方向由X=i或X=i+△X截得的长度py和cy，以及位于xOz面上的多边形在Z轴方向由X=i或X=i+△X截得的长度pz和cz。这两个长度相乘，py×pz和cy×cz就是X=i或X=i+△X时对应的两个底面积，也就对应上面体积公式的S<sub>上</sub>和S<sub>下</sub>。而4×S<sub>中</sub>则等于(py+cy)×(pz+cz)。代入体积公式，可以求得单个拟棱柱的体积。累加这些分量的体积，结果就是总体积的精确值。

因此，X=i时在Y或Z轴对应的长度比较容易找。直接枚举X=i经过横截面的哪些边即可。由于两个棱柱的截面都是凸多边形，X=i只会进多边形一次，出多边形一次，中间不会形成“空洞”。

下面有两个代码。代码1是在求X=i时，遍历另一个横截面多边形数组，找出X在这个多边形中截得的长度。代码2是预先把X=i时，把在两个多边形截得的长度预处理出来，计算面积时直接使用。

可以看出，如果把S<sub>上</sub>、S<sub>中</sub>与S<sub>下</sub>分别改写成f(x),f(x+△X/2)与f(x+△X)，f(x)代表某个横截矩形的面积，那么该公式与辛普森积分公式形式上一致。这是一种巧合么？

