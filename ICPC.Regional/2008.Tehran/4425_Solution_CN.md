# 2008 Tehran: Another Brick in the Wall

## Solution

1. 预处理出所有砖头，给这些砖头加上编号
2. 建立正向和反向的拓扑关系图。如果砖头A的取出能够导致砖头B的坍塌，那么正向图中A到B有连边。如果砖头B的坍塌依赖于砖头A，那么反向图中B到A有连边。一个砖头的坍塌有可能依赖于多个砖头。明显，我们建出来的拓扑关系图是有层次的。
3. 枚举每个砖头，对正向图进行BFS，对于访问过的砖头，如果其会坍塌，则标记其为visit。每次访问一个砖头x，要知道其是否会坍塌，只需要遍历反向图中x的儿子，看看这些儿子是不是全部是visit即可。

一个小小的常数优化：只有正向图中入度不为1的砖头，才对其进行BFS。因为入度为1的砖头，明显拆其父亲节点的砖头能够造成更大的损害。
